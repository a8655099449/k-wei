(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{605:function(t,a,e){"use strict";e.r(a);var c=e(5),v=Object(c.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"什么是缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是缓存"}},[t._v("#")]),t._v(" 什么是缓存？")]),t._v(" "),e("p",[t._v("浏览器缓存是指浏览器会将请求过的资源存储到本地磁盘中，下次再访问，优先从本地读取。")]),t._v(" "),e("h3",{attrs:{id:"缓存的优点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存的优点"}},[t._v("#")]),t._v(" 缓存的优点")]),t._v(" "),e("ol",[e("li",[t._v("提高网站的响应速度")]),t._v(" "),e("li",[t._v("减少服务器压力")]),t._v(" "),e("li",[t._v("减少用户流量损耗")])]),t._v(" "),e("h3",{attrs:{id:"缓存的缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存的缺点"}},[t._v("#")]),t._v(" 缓存的缺点")]),t._v(" "),e("ol",[e("li",[t._v("更新不及时，用户看到的可能是老内容")])]),t._v(" "),e("h2",{attrs:{id:"缓存的流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存的流程"}},[t._v("#")]),t._v(" 缓存的流程")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b354e0a8cb2450aba81bc12e03d774e~tplv-k3u1fbpfcp-zoom-1.image?imageslim",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"缓存的规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存的规则"}},[t._v("#")]),t._v(" 缓存的规则")]),t._v(" "),e("p",[t._v("缓存的规则分为两种 "),e("code",[t._v("强缓存")]),t._v("和"),e("code",[t._v("协议缓存")])]),t._v(" "),e("h3",{attrs:{id:"强缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#强缓存"}},[t._v("#")]),t._v(" 强缓存")]),t._v(" "),e("p",[t._v("这种缓存是浏览器自动的缓存，判断缓存资源是否过期，如果没过期就使用缓存内容")]),t._v(" "),e("p",[t._v("如何判断是否是强缓存？且有没有过期？")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2fef124c55304637bbf89591ea947131~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[t._v("在网络请求的"),e("code",[t._v("response headers")]),t._v("内找到"),e("code",[t._v("Cache-Control")]),t._v("的字段，一般"),e("code",[t._v("max-age = 31xxxxxxx")]),t._v(" 这种就属于强缓存后面跟的value就属于缓存的秒数")]),t._v(" "),e("p",[t._v("Cache-Control  的属性说明")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("字段值")]),t._v(" "),e("th",[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("private")])]),t._v(" "),e("td",[t._v("仅浏览器可以缓存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("public")])]),t._v(" "),e("td",[t._v("浏览器和代理服务器都可以缓存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("max-age=xxx")])]),t._v(" "),e("td",[t._v("过期时间（重要）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("no-cache")])]),t._v(" "),e("td",[t._v("不进行强制缓存（重要）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("code",[t._v("no-store")])]),t._v(" "),e("td",[t._v("不强缓存，也不协商缓存，基本不用")])])])]),t._v(" "),e("p",[t._v("规则可以同时存在多个")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c50fd6d7f97c41458a2b60cf8c2601af~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[t._v("对于强缓存，我们只要的研究对象是 "),e("code",[t._v("max-age")]),t._v(" 和 "),e("code",[t._v("no-cache")])]),t._v(" "),e("p",[t._v("判断是否命中强缓存，主要看"),e("code",[t._v("response")]),t._v(" 的 "),e("code",[t._v("Cache-Control")]),t._v(" 字段值，如果有max-age=xxx秒，则命中强缓存。如果Cache-Control的值是no-cache，说明没命中强缓存，走协商缓存。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/07f8dcf612474aa3b35ebea794f06fbe~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c27d01f81b746db9594013415232287~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[e("code",[t._v("max-age = 0")]),t._v(" 和 "),e("code",[t._v("no-cache")]),t._v(" 的区别在于"),e("code",[t._v("no-cache")]),t._v("直接不进行强缓存，让你去走协商缓存，而"),e("code",[t._v("max-age=0")]),t._v("是进行强缓存，但是过期了，需要更新, 两者的效果实际是差不多的。")])]),t._v(" "),e("h2",{attrs:{id:"协商缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存"}},[t._v("#")]),t._v(" 协商缓存")]),t._v(" "),e("p",[t._v("协商缓存的触发条件")]),t._v(" "),e("ol",[e("li",[t._v("Cache-Control 的值为 no-cache （不强缓存）")]),t._v(" "),e("li",[t._v("max-age 过期了 （强缓存，但总有过期的时候）")])]),t._v(" "),e("p",[t._v("也就是说除了 "),e("code",[t._v("no-store")]),t._v(" 以外 , 最后都还是要走协议缓存")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cfd149d78c3e4e25a3d5ce6128bb65b1~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[t._v("在这个图中，虽然强缓存命中，但是也有 ETag 和 Last-Modified ，这两个就是协商缓存的相关规则。虽然之前的强缓存流程和他俩没关。。。")]),t._v(" "),e("p",[e("code",[t._v("ETag")]),t._v("：每个文件有一个，改动文件了就变了，可以看似md5")]),t._v(" "),e("p",[e("code",[t._v("Last-Modified")]),t._v("：文件的修改时间")]),t._v(" "),e("p",[t._v("我们可以根据这两个值来判断文件是否修改了，只需要在下一次请求将这两个值带上（但是名字变了ETag--\x3eIf-None-Match，Last-Modified--\x3eIf-Modified-Since ），服务端把你带过来的标识，资源目前的标识，进行对比，然后判断资源是否更改了。")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/58e4541b60f44ff7ac7e9cf6c1242ba0~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77ece84bcd294d22bdc966362248663e~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"缓存命中显示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存命中显示"}},[t._v("#")]),t._v(" 缓存命中显示")]),t._v(" "),e("ol",[e("li",[t._v("从服务器获取新的资源")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/402c62c9bc2d46d485c43abe6205a23f~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("命中强缓存且没过期，直接读取本地")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/27976c4bcca3415abaca5c85a862afe4~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("ol",{attrs:{start:"3"}},[e("li",[t._v("命中协商缓存，且资源未更改，读取本地缓存")])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a9096f25e1846dbac0d7203825ff9ff~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"配置缓存的规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置缓存的规则"}},[t._v("#")]),t._v(" 配置缓存的规则")]),t._v(" "),e("p",[t._v("可以在后端配置，也可以在"),e("code",[t._v("nginx")]),t._v("中配置")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/090c3c7058614a788ef3af402de9016c~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"用户行为对于缓存的影响"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用户行为对于缓存的影响"}},[t._v("#")]),t._v(" 用户行为对于缓存的影响")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/df4081f9d78a424782119e8fb31d8fd9~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"强缓存与协商缓存的区别可以用下表来表示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#强缓存与协商缓存的区别可以用下表来表示"}},[t._v("#")]),t._v(" 强缓存与协商缓存的区别可以用下表来表示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a05986cd9044b878a4148252c46bcd0~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("h2",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c819577cba3746ddaa2e25a58bed84a4~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/244a7d5cf07f421ba9d4e3dbb4a27bf4~tplv-k3u1fbpfcp-zoom-1.image",alt:"alt"}})]),t._v(" "),e("p",[t._v("参考链接")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://juejin.cn/post/6844903763665240072#heading-4",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器缓存(掘金)"),e("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=v.exports}}]);