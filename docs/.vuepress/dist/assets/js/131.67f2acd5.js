(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{666:function(s,a,n){"use strict";n.r(a);var t=n(5),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("前面曾提到过"),n("code",[s._v("server")]),s._v(" 是nginx配置中一个相对重要的模块")]),s._v(" "),n("h2",{attrs:{id:"listen"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#listen"}},[s._v("#")]),s._v(" listen")]),s._v(" "),n("p",[n("strong",[s._v("表示被监听的端口")])]),s._v(" "),n("h2",{attrs:{id:"server-name"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#server-name"}},[s._v("#")]),s._v(" server_name")]),s._v(" "),n("p",[s._v("表示访问的地址， 可以支持域名访问")]),s._v(" "),n("h2",{attrs:{id:"location"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#location"}},[s._v("#")]),s._v(" location")]),s._v(" "),n("p",[s._v("location 后面通常增加的是匹配的方式")]),s._v(" "),n("p",[n("strong",[s._v("比如以下的配置 就可以根据不同的路径来返回不同的内容")])]),s._v(" "),n("div",{staticClass:"language-conf line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("location / {\n    root   html;\n    index  index.html index.htm;\n}\nlocation /get_text {\n    default_type text/plain ;\n    return 200 '<h1>this is cccc</h1>';\n}\n\nlocation /get_html {\n    default_type text/html ;\n    return 200 '<h1>this is html</h1>';\n}\n\nlocation /get_json {\n    default_type application/json ;\n    return 200 '{\"name\":\"张三 \"}';\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("路径的匹配分为很多种模式")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("只以"),n("code",[s._v("/")]),s._v("开头， 比如"),n("code",[s._v("/get_text")]),s._v(" ， 属于"),n("strong",[s._v("不严格匹配")]),s._v(" ，以上的例子可以被 "),n("code",[s._v("/get_textaaa")]),s._v("匹配到")])]),s._v(" "),n("li",[n("p",[s._v("以"),n("code",[s._v("~/")]),s._v("开头，比如"),n("code",[s._v("~/get_text")]),s._v("，严格匹配，只有该路径会被匹配到")])]),s._v(" "),n("li",[n("p",[s._v("以正则表达式匹配 "),n("code",[s._v("~")]),s._v(" 或者"),n("code",[s._v("~*")]),s._v(" 开启 ， 后者不区分大小写")])]),s._v(" "),n("li",[n("p",[s._v("以"),n("code",[s._v("^~")]),s._v(" 开头，匹配到了以后，不再进行后面的匹配")])])]),s._v(" "),n("h2",{attrs:{id:"设置文件目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置文件目录"}},[s._v("#")]),s._v(" 设置文件目录")]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("root字段")]),s._v(" 和"),n("code",[s._v("alias")]),s._v(" 字段都能设置访问资源 ，")]),s._v(" "),n("p",[s._v("它们的区别是：")]),s._v(" "),n("p",[s._v("root ： "),n("code",[s._v("root路径 + location路径")])]),s._v(" "),n("p",[s._v("alias :  "),n("code",[s._v("alias 替换location路径")])]),s._v(" "),n("h2",{attrs:{id:"index指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#index指令"}},[s._v("#")]),s._v(" index指令")]),s._v(" "),n("p",[s._v("就是默认访问的内容  ， 不只是支持"),n("code",[s._v("html")]),s._v("也支持其他的文件内容")]),s._v(" "),n("h2",{attrs:{id:"error-page-指令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#error-page-指令"}},[s._v("#")]),s._v(" error_page 指令")]),s._v(" "),n("p",[s._v("设置错误页面")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 错误的时候跳转到首页面\nerror_page 404  /  ;  \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"优化静态资源配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#优化静态资源配置"}},[s._v("#")]),s._v(" 优化静态资源配置")]),s._v(" "),n("p",[s._v("优化静态资源可以从是三个指令入手"),n("code",[s._v("sendfile \\ tcp_nopush \\ tcp_nodelay")])]),s._v(" "),n("p",[s._v("建议就是把这个三个指令都打开，可以优化静态资源的访问速度")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("sendfile : on ;\ntcp_nopush:on;\ntcp_nodelay:on;\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"静态资源压缩"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#静态资源压缩"}},[s._v("#")]),s._v(" 静态资源压缩")]),s._v(" "),n("p",[s._v("压缩后的静态资源可以得到更快的传输速度")]),s._v(" "),n("p",[s._v("主要用到以下的指令")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nnginx_http_gzip_module\nnginx_http_gzip_static_module\nnginx_http_gunzip_module\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("ol",[n("li",[s._v("gzip 各个模块的配置指令")]),s._v(" "),n("li",[s._v("gzip 压缩功能配置")]),s._v(" "),n("li",[s._v("gzip 和 sendfile 冲突解决")]),s._v(" "),n("li",[s._v("浏览器不支持gzip的解决方案")])]),s._v(" "),n("p",[s._v("如果要开启 gzip压缩，我们只需要这样")]),s._v(" "),n("div",{staticClass:"language-config line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("gzip on ;\n# 除此之外，还需要指定需要压缩的文件类型 * 代表所有文件 默认只对html文件进行压缩。\ngzip_types *;\n# 压缩的等级 1-9 越高文件越小，但建议在6 后三级提升不大\ngzip_comp_level 6; \n\n# 是否携带 `Vary:Accept-Encoding`头部的响应头部 ， 浏览器会根据这个字段得知是否经过压缩\ngzip_vary\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);