---
title: react hooks çš„ä½¿ç”¨
date: 2021-01-16
tags:
 - å‰ç«¯
 - react
categories: code
# pic : '//image.woai996.com/picGo/20210116222659.png' 
pic : 'https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1109098411,291783808&fm=15&gp=0.jpg' 
---

## react-hook æ˜¯ä»€ä¹ˆï¼Ÿ

åœ¨æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„reactä¸­ï¼Œç»„ä»¶åˆ†ä¸º`å‡½æ•°å¼ç»„ä»¶`å’Œ`ç±»ç»„ä»¶`ï¼Œä¹Ÿæˆä¸º`æœ‰çŠ¶æ€ç»„ä»¶`å’Œ`æ— çŠ¶æ€ç»„ä»¶` , æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„åœºæ™¯æ¥åˆ†åˆ«ä½¿ç”¨ã€‚<br>
ä½†æœ‰çš„æ—¶å€™ï¼Œæ™®é€šçš„å‡½æ•°å¼ç»„ä»¶å¹¶æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚,ä½†ä½¿ç”¨ç±»ç»„ä»¶åˆæµªè´¹äº†æ€§èƒ½ï¼Œ`react-hook` å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬åœ¨`å‡½æ•°å¼ç»„ä»¶`ä¸­ï¼Œä½¿ç”¨ä¸€äº›`ç±»ç»„ä»¶`çš„ç‰¹æ€§<br>
[å®˜æ–¹æ–‡æ¡£é“¾æ¥](https://react.docschina.org/docs/hooks-intro.html)<br>
ä¸‹é¢`react hook` ä¼šç®€ç§°ä¸º `hook`

:::warning
Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ , ä½¿ç”¨å‰è¯·ç¡®è®¤ä½ çš„reactç‰ˆæœ¬
:::

## useState çš„ä½¿ç”¨
> `useState` å¯èƒ½æ˜¯åˆä½¿ç”¨hooksç»„ä»¶ä½¿ç”¨çš„æœ€å¤šçš„hooksï¼Œ å®ƒå¯ä»¥ä½¿æˆ‘ä»¬çš„å‡½æ•°å¼ç»„ä»¶æ‹¥æœ‰å†…éƒ¨çš„çŠ¶æ€

1. å¼•å…¥useStateçš„å‡½æ•°
```js
import React,{useState} from 'react'
```
2. è®¾ç½®ä¸€ä¸ªçŠ¶æ€ ï¼ŒçŠ¶æ€å¾€å¾€æ˜¯ `çŠ¶æ€å˜é‡` + `è®¾ç½®çŠ¶æ€çš„å‡½æ•°` å‡ºç°
```jsx
import React,{useState} from 'react'

export default () =>{
  let  [name,setName] = useState('å¼ ä¸‰')
  return(
    <div>
      æˆ‘çš„åå­—æ˜¯{name}
    </div>
  )
}
```
3. æ”¹å˜çŠ¶æ€ ï¼Œ ä¸Šé¢æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ª `setName`çš„å‡½æ•° å°±æ˜¯ä¸ºäº†åç»­å¯ä»¥æ”¹å˜çŠ¶æ€ä½¿ç”¨

```jsx
import React,{useState} from 'react'

export default () =>{
  let  [name,setName] = useState('å¼ ä¸‰')
  return(
    <div>
      æˆ‘çš„åå­—æ˜¯{name}
      <div>
        {/* setNameçš„å‚æ•°å°±æ˜¯ä¼ é€’ç»™nameçš„å€¼ */}
        <button onClick={()=>setName('æå››')}>æ”¹å˜åå­—ä¸º æå›› </button>
      </div>
    </div>
  )
}

```
4. å£°æ˜å¤šä¸ªçŠ¶æ€ 
> è¯æ˜å¤šä¸ªçŠ¶æ€å…¶å®å¾ˆå¥½ç†è§£ï¼Œåªè¦è®°ä½ï¼Œå£°æ˜æ—¶æ˜¯ä»¥è¿™ç§æ ¼å¼å‡ºç°çš„å°±å¯ä»¥ `let [çŠ¶æ€å,æ”¹å˜çŠ¶æ€çš„å‡½æ•°] = useState(åˆå§‹å€¼)`

```jsx
import React,{useState} from 'react'

export default () =>{
  let  [name,setName] = useState('å¼ ä¸‰')
  let  [age,setName] = useState(18)
  let  [sex,setName] = useState('ç”·')
  return(
    <div>
      æˆ‘çš„åå­—æ˜¯{name}
      <div>
        <button onClick={()=>setName('æå››')}>æ”¹å˜åå­—ä¸º æå›› </button>
      </div>
    </div>
  )
}
```
:::tip
æˆ‘ä»¬å‘ç°ï¼Œä½¿ç”¨`hook`å¥½åƒæ¯”ä¹‹å‰çš„`ç±»ç»„ä»¶`è¦æ–¹ä¾¿çš„å¤šï¼Œå†ä¹Ÿæ²¡æœ‰thisæŒ‡å‘çš„é—®é¢˜ï¼Œå…¶å®`hook`ç¡®å®å¯ä»¥æ‰¿æ‹…`ç±»ç»„ä»¶`çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½
:::


## useEffect çš„ä½¿ç”¨ 
ç±»ç»„ä»¶çš„å¦ä¸€å¤§ç‰¹æ€§å°±æ˜¯æœ‰å„ç§ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œ`useEffect` å°±æ˜¯hookä¸­çš„å„ç§ç”Ÿå‘½å‘¨æœŸå‡½æ•°
1. æ™®é€šçš„ä½¿ç”¨
> useEffectçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“çŠ¶æ€æ›´æ”¹æ—¶ï¼Œå°±ä¼šè§¦å‘, ç›¸å½“äº`componentDidUpdate`
```jsx
import React,{useState,useEffect} from 'react'

export default () =>{
  
  let  [name,setName] = useState('å¼ ä¸‰')
  let  [age,setAge] = useState(18)

  // useEffectçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“çŠ¶æ€æ›´æ”¹æ—¶ï¼Œå°±ä¼šè§¦å‘
  useEffect(()=>{
    console.log('çŠ¶æ€å‘ç”Ÿæ”¹å˜');
  })
  return( 
    <div>
      æˆ‘çš„åå­—æ˜¯{name}
      <br/>
      æˆ‘çš„åå­—æ˜¯{age}
      <div>
        <button onClick={()=>setName('æå››')}>æ”¹å˜åå­—ä¸º æå›› </button>
        <button onClick={()=>setAge(age+1)}>age + 1 </button>
      </div>
    </div>
  )
}

```
2. å®ç° `componentDidMount` å’Œ `componentWillUnmount` 
:::tip
ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªæœ‰åœ¨æ•°ç»„ä¸­çš„å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå›è°ƒå‡½æ•°æ‰ä¼šè§¦å‘ <br>
æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå‡å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„æ˜¯ [] ï¼Œé‚£ä¹ˆå›è°ƒå‡½æ•°çš„å†…å®¹åªæœ‰åœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶å€™ä¼šè§¦å‘  <br>
useEffectè¿˜å¯ä»¥returnä¸€ä¸ªå‡½æ•° <br>
returnçš„å‡½æ•°åªæœ‰åœ¨ç»„ä»¶è¢«å¸è½½æ—¶è§¦å‘

:::
```jsx
useEffect(()=>{
  console.log('ç»„ä»¶è¢«åˆ›å»ºäº†');
  return ()=>{
    console.log('ç»„ä»¶è¢«å¸è½½äº†');
  }
},[])

useEffect(()=>{
  console.log('æˆ‘åªæœ‰åœ¨ageå‘ç”Ÿæ”¹å˜æ—¶è§¦å‘');
},[age])
```

## useConetext çš„ä½¿ç”¨
> `useConetext` æ‰€è§£å†³çš„é—®é¢˜æ˜¯ç»„ä»¶ä¸­çˆ¶å­ç»„ä»¶ä¼ å€¼çš„é—®é¢˜
:::details  æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•
```jsx
import React, {useState, createContext, useContext} from 'react';

let Context = createContext();

const ChildCom = () => {
  let { age } = useContext(Context);
  return <div>çˆ¶ç»„ä»¶ä¼ æ¥çš„ {age}</div>;
};

export default () => {
  let [age, setAge] = useState(18);

  return (
    <div>
      æˆ‘çš„åå­—æ˜¯{age}
      <div>
        <button onClick={() => setAge(age + 1)} >
          age + 1{' '}
        </button>
      </div>
      <Context.Provider
        value={{
          age: age,
        }}
      >
        <ChildCom />
      </Context.Provider>
    </div>
  );
};

```
:::

## useRuducer çš„ä½¿ç”¨
> useRuducer å¯ä»¥å®ç°ç±»ä¼¼ `redux` çš„åŠŸèƒ½

###  useRuducer çš„åŸºç¡€ä½¿ç”¨æ–¹æ³•
:::details æŸ¥çœ‹ä»£ç 
```jsx
import React, { useReducer} from 'react';


export default () => {

  //  useReducer ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥reducer  ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé»˜è®¤å€¼
  let [state, dispacth] = useReducer((state ,action)=>{
    console.log(action.type);
    switch (action.type) {
      case 'add':
        state.age++
        break;
      case 'sub':
        state.age--
        break;
    }
    return {...state}
  },{age:18});

  return (
    <div>
      æˆ‘çš„åå­—æ˜¯{state.age}
      
      <div>
        <button onClick={() =>dispacth({type:'add'})} className="btn btn-blue">
          age + 1{' '}
        </button>
      </div>
    </div>
  );
};

```
:::


## åœ¨hooksç»„ä»¶ä¸­è·å¾—å®ä¾‹
> å¦‚ä½•ä¼ å…¥ä¸€ä¸ª`ref`æ¥è·å¾—hooksç»„ä»¶ä¸­çš„å®ä¾‹ï¼Ÿ

æœ‰å‡ ä¸ªå…³é”®çš„api`forwardRef` \ `useImperativeHandle`

:::tip hooksç»„ä»¶

```js
import React, { useImperativeHandle } from "react";
const Demo = React.forwardRef((props, ref) => {
  useImperativeHandle(ref, () => {
    return {
      show(){
        console.log('ğŸ‘´å±•ç¤ºç»„ä»¶',)
      }
    };
  });

  return <div>Demo</div>;
});

export default Demo;
```
:::

:::tip ä½¿ç”¨

```jsx
import { Button } from 'antd'
import React, { useRef } from 'react'
import Demo from '.'
const Parent = (props) =>{
  const ref = useRef()
  return(
    <div>
      <Button onClick={e=>{
        ref.current.show()
      }}>
        å±•ç¤º
      </Button>
      <Demo  ref={ref}/>
    </div>
  )
}

export default Parent
```
:::



